
<% if controller_name == 'queries' && action_name == 'new' %>
  <%= simple_form_for @query, url: csv_file_queries_path do |f| %>
    <%= f.input :query_name %>
    <input type="checkbox" onclick="toggle(this);" /> Select all<br />
    <%= f.input :fields, collection: @order_data_types.keys, input_html: { multiple: true }, as: :check_boxes %>
    <%= render :partial => "/filters/filter_form", locals: { :f => f, :query => @query, :filter_comparisons => @filter_comparisons, :order_data_types => @order_data_types } %>
    <%= f.submit class: "button-primary" %>
  <% end %>
<% elsif controller_name == 'queries' && action_name == 'edit' %>
  <%= simple_form_for @query, url: csv_file_query_path do |f| %>
    <%= f.input :query_name %>
    <%= f.input :fields, collection: @order_data_types.keys, input_html: { multiple: true }, checked: @checked_fields, as: :check_boxes %>
    <%= render :partial => "/filters/filter_form", locals: { :f => f, :query => @query, :filter_comparisons => @filter_comparisons, :order_data_types => @order_data_types } %>
    <%= f.submit class: "button-primary" %>
  <% end %>
<% end %>

<script>
  function toggle(source) {
    console.log("checkbox clicked!");
    var checkboxes = document.querySelectorAll('.query_fields > div > input');
    console.log(checkboxes);
    for (var i = 0; i < checkboxes.length; i++) {
        if (checkboxes[i] != source) {
            checkboxes[i].checked = source.checked;
        }
    }
  }
</script>